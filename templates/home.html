{% extends "base.html" %} {% block content %}
<section class="container mx-auto px-4 mt-8 min-h-screen">
  <div class="text-center py-10">
    <p>
      This tool will help you to get a comprehensive summary of the reviews of
      any Steam game.
    </p>
    <p>Search for a videogame and then click on the "Get Report" button.</p>
    <br />
    <form id="steam-form">
      <table>
        <tr>
          <td>
            <label for="game-name" id="game-name-label">Enter Game Name:</label>
          </td>
          <td>
            <input type="text" id="game-name" name="game_name" />

            <script type="text/javascript">
              $("#game-name").autocomplete({
                source: function (request, response) {
                  $.getJSON(
                    "{{url_for('search_route')}}",
                    {
                      term: request.term,
                    },
                    function (data) {
                      // we map according to the dictionary we get from Flask
                      var autocompleteData = $.map(
                        data.matching_results,
                        function (v, i) {
                          return {
                            label: v.name,
                            value: v.id,
                          };
                        }
                      );

                      response(autocompleteData);
                    }
                  );
                },
                minLength: 2,
                select: function (event, ui) {
                  $("#steam-id").val(ui.item.value);
                },
              });
            </script>
          </td>
          <td>
            <button type="submit">Get Report</button>
          </td>
        </tr>
        <tr style="display: none">
          <td>
            <input type="text" id="steam-id" name="steam_id" required />
          </td>
        </tr>
      </table>
    </form>
    {% if session['paid_user'] %}
    <!-- Custom Prompt for paid users -->
    <div id="custom-prompt">
      <p>Custom Prompt:</p>
      <textarea cols="50" rows="5" id="prompt" name="prompt"></textarea>
    </div>
    {% endif %}
    <div id="title" class="text-3xl title-text mb-4"></div>
    <div id="summary" class="text-lg summary-text">
      The summary of the reviews will be displayed here...
    </div>
  </div>
  <script src="/static/js/form_handler.js"></script>
</section>
{% endblock %}
